<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>GreenLaunch Route Tester</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px;
      background: #f5f5f5;
      color: #222;
    }
    h1 {
      margin-bottom: 0.5rem;
    }
    section {
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 24px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
    }
    label {
      display: block;
      margin: 12px 0 4px;
      font-weight: bold;
    }
    input, select {
      width: 100%;
      padding: 8px;
      border-radius: 4px;
      border: 1px solid #ccc;
    }
    button {
      margin-top: 12px;
      padding: 10px 16px;
      border: none;
      border-radius: 4px;
      background-color: #2563eb;
      color: #fff;
      font-size: 0.95rem;
      cursor: pointer;
    }
    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }
    pre {
      margin-top: 16px;
      background: #111827;
      color: #e5e7eb;
      padding: 16px;
      border-radius: 6px;
      overflow-x: auto;
      font-size: 0.9rem;
    }
  </style>
</head>
<body>
  <h1>GreenLaunch Route Tester</h1>
  <p>Use this page to send quick requests to the GreenLaunch backend running on <code>http://localhost:4000/api/greenlaunch</code>.</p>

  <section>
    <h2>Configuration</h2>
    <label for="baseUrl">API Base URL</label>
    <input id="baseUrl" type="text" value="http://localhost:4000/api/greenlaunch" />
  </section>

  <section>
    <h2>Emission Estimate</h2>
    <label for="rocketId">Rocket</label>
    <select id="rocketId">
      <option value="falcon9">Falcon 9</option>
      <option value="newGlenn">New Glenn</option>
      <option value="ariane6">Ariane 6</option>
    </select>

    <label for="destination">Destination</label>
    <select id="destination">
      <option value="moon">Moon</option>
      <option value="mars">Mars</option>
    </select>

    <label for="launchSite">Ontario Launch Site</label>
    <select id="launchSite">
      <option value="timmins">Timmins</option>
      <option value="chapleau">Chapleau</option>
    </select>

    <label for="payloadMass">Payload Mass (kg)</label>
    <input id="payloadMass" type="number" placeholder="2750" />

    <button id="runEstimate">Run POST /estimate</button>
    <pre id="estimateResult">No request sent yet.</pre>
  </section>

  <section>
    <h2>Gemini Brief</h2>
    <label for="tone">Tone</label>
    <select id="tone">
      <option value="educator">Educator</option>
      <option value="student-friendly">Student Friendly</option>
      <option value="executive">Executive</option>
      <option value="technical">Technical</option>
    </select>

    <button id="runBrief">Run POST /brief</button>
    <pre id="briefResult">No request sent yet.</pre>
  </section>

  <section>
    <h2>Reference Data</h2>
    <button id="runReference">Run GET /reference</button>
    <pre id="referenceResult">No request sent yet.</pre>
  </section>

  <script>
    const baseUrlInput = document.getElementById('baseUrl');
    const runEstimateBtn = document.getElementById('runEstimate');
    const runBriefBtn = document.getElementById('runBrief');
    const runReferenceBtn = document.getElementById('runReference');

    const estimateResult = document.getElementById('estimateResult');
    const briefResult = document.getElementById('briefResult');
    const referenceResult = document.getElementById('referenceResult');

    const fetchJson = async (url, options = {}) => {
      const res = await fetch(url, {
        headers: { 'Content-Type': 'application/json' },
        ...options
      });
      if (!res.ok) {
        const text = await res.text();
        throw new Error(`HTTP ${res.status}: ${text}`);
      }
      return res.json();
    };

    runEstimateBtn.addEventListener('click', async () => {
      try {
        runEstimateBtn.disabled = true;
        estimateResult.textContent = 'Loading...';

        const payload = {
          rocketId: document.getElementById('rocketId').value,
          destination: document.getElementById('destination').value,
          launchSite: document.getElementById('launchSite').value,
          payloadMassKg: Number(document.getElementById('payloadMass').value) || undefined
        };

        const baseUrl = baseUrlInput.value.replace(/\/$/, '');
        const data = await fetchJson(`${baseUrl}/estimate`, {
          method: 'POST',
          body: JSON.stringify(payload)
        });

        estimateResult.textContent = JSON.stringify(data, null, 2);
      } catch (err) {
        estimateResult.textContent = err.message;
      } finally {
        runEstimateBtn.disabled = false;
      }
    });

    runBriefBtn.addEventListener('click', async () => {
      try {
        runBriefBtn.disabled = true;
        briefResult.textContent = 'Loading...';

        const payload = {
          rocketId: document.getElementById('rocketId').value,
          destination: document.getElementById('destination').value,
          launchSite: document.getElementById('launchSite').value,
          payloadMassKg: Number(document.getElementById('payloadMass').value) || undefined,
          tone: document.getElementById('tone').value
        };

        const baseUrl = baseUrlInput.value.replace(/\/$/, '');
        const data = await fetchJson(`${baseUrl}/brief`, {
          method: 'POST',
          body: JSON.stringify(payload)
        });

        briefResult.textContent = JSON.stringify(data, null, 2);
      } catch (err) {
        briefResult.textContent = err.message;
      } finally {
        runBriefBtn.disabled = false;
      }
    });

    runReferenceBtn.addEventListener('click', async () => {
      try {
        runReferenceBtn.disabled = true;
        referenceResult.textContent = 'Loading...';

        const baseUrl = baseUrlInput.value.replace(/\/$/, '');
        const data = await fetchJson(`${baseUrl}/reference`);
        referenceResult.textContent = JSON.stringify(data, null, 2);
      } catch (err) {
        referenceResult.textContent = err.message;
      } finally {
        runReferenceBtn.disabled = false;
      }
    });
  </script>
</body>
</html>

